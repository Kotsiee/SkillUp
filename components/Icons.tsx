// deno-lint-ignore-file no-explicit-any
import { animate } from "https://esm.sh/motion@11.15.0";
import { Component, createRef } from "preact";

interface AIconProps{
  size?: number
  colour?: string
  startPaths: string[];
  endPaths?: string[];
  onClick?: (state: boolean) => void;
  onHover?: () => void;
  offHover?: () => void;
  initalState?: boolean;
  className?: string
}

interface AIconState extends AIconProps{
}

export default class AIcon extends Component<AIconProps, AIconState>{
  pRefs: (SVGPathElement)[] = [];
  svg = createRef<SVGSVGElement>();
  started: boolean = false
  initPaths: string[] = []

  constructor (props: any){
    super(props);

    this.state = {
      size: props.size || 24,
      colour: props.colour || 'white',
      startPaths: props.startPaths,
      endPaths: props.endPaths,
      ...props
    };
  }

  startClick(){
    if(this.pRefs){
      this.pRefs.forEach((path, index) => {
        animate(path, { d: this.started ? this.state.startPaths[index] : this.state.endPaths![index] }, { duration: 0.2 });
      });
    }

    if (!this.started) this.svg?.current?.classList.add("active")
    else this.svg?.current?.classList.remove("active")
  }

  click(){
    if (this.state.endPaths) this.startClick()
    if (this.state.onClick) this.state.onClick(this.started);
    
    this.started = !this.started;
  }

  override componentDidMount(): void {
    this.started = this.state.initalState ? this.state.initalState : false

    if (this.started) {
      this.svg?.current?.classList.add("active")
      this.pRefs.forEach((path, index) => {
        path.setAttribute('d', `${this.state.endPaths?.[index] ? this.state.endPaths[index]  : this.state.startPaths[index]}`)
      })
    }
    else{
      this.svg?.current?.classList.remove("active")
    }
  }

  onMouseEnter = () => { if (this.state.onHover) this.state.onHover(); };
  onMouseLeave = () => { if (this.state.offHover) this.state.offHover(); };

  render(){
    const { size, colour, startPaths } = this.state;
    
    return(
        <svg
          ref={this.svg}
          width={size}
          height={size}
          viewBox="0 0 24 24"
          fill-rule="evenodd"
          xmlns="http://www.w3.org/2000/svg"
          stroke={colour}
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"

          class={`${this.state.className} icon animatedIcon`}
          onClick={() => this.click()}
          onMouseEnter={this.onMouseEnter}
          onMouseLeave={this.onMouseLeave}
        >
          {startPaths!.map((d, index) => {
            return(
              <path
                key={index}
                ref={(el) => el && (this.pRefs[index] = el)}
                strokeLinecap="round"
                strokeLinejoin="round"
                d={d}
              />
            )
          })}
        </svg>
    )
  }
}

const calcCirc = (posX: number, posY: number, r: number) => {
  return `M ${posX} ${posY} m ${r} 0 a ${r} ${r} 0 1 0 -${r * 2} 0 a ${r} ${r} 0 1 0 ${r * 2} 0`
}

export const Icons: Record<string, string[]> = {
  Home: [
    'M3 9L12 2L21 9V20C21 20.55 20.55 21 20 21H4C3.45 21 3 20.55 3 20V9Z',
    'M9 21V12H15V21'
  ],
  Search: [
    'M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z',
    'M21 21L16.65 16.65'
  ],
  Settings: [
    'M 12 1 L 22 6 L 22 18 L 12 23 L 2 18 L 2 6 L 12 1 Z M 12 8 A 4 4 0 1 1 12 16 A 4 4 0 1 1 12 8 Z'
  ],
  Plus: [
    'M 12 2 L 12 22 Z',
    'M 2 12 L 22 12 Z'
  ],
  X: [
    'M 20 20 L 4 4 Z',
    'M 20 4 L 4 20 Z'
  ],
  Tick: [
    'M 2 12 L 10 20 L 22 2'
  ],
  Menu: [
    'M 1 6 L 23 6 Z',
    'M 1 18 L 23 18 Z'
  ],
  UpChevron: [
    'M 2 16 L 12 8 L 22 16'
  ],
  DownChevron: [
    'M 2 8 L 12 16 L 22 8'
  ],
  SortSwitch: [
    'M 2 8 L 8 2 L 8 22',
    'M 16 2 L 16 22 L 22 16'
  ],
  Sort: [
    'M 2 4 L 22 4',
    'M 2 12 L 18 12',
    'M 2 20 L 14 20'
  ],
  Filter: [
    'M 1 1 L 23 1 L 15 10 L 15 18 L 9 22 L 9 10 Z'
  ],
  Save: [
    'M 2 2 L 22 2 L 22 22 L 12 16 L 2 22 Z'
  ],
  Hr: [
    'M 2 12 L 22 12'
  ],
  Vr: [
    'M 12 2 L 12 22'
  ],
  DotMenu: [
    calcCirc(12, 4, 2),
    calcCirc(12, 12, 2),
    calcCirc(12, 20, 2)
  ],
  Send: [
    'M 2 2 L 22 12 L 2 22 L 6 14 L 14 12 L 6 10 Z'
  ],
  Bold: [
    "m 16.5,11.5 q 1.5,0.5 2.5,0.5 0.5,0.5 1.5,1.5 0.5,1 0.5,2.5 0,1 -0.5,2 -0.5,1 -1.5,1.5 -1,0.5 -3,1 -1.5,0.5 -4.5,0.5 -1.5,0 -3,-0.05 -1.5,0 -2.5,-0.05 -1.5,-0.05 -2.5,-0.5 V 2.5 q 1,-0.05 2.5,-0.5 1,-0.05 2.5,-0.05 1.5,-0.05 3,-0.05 2.5,0 4,0.5 1.5,0.5 2.5,1.5 1,0.5 1.5,1.5 0.5,1 0.5,2 0,1 -0.5,2 -0.5,1 -1,1.5 -1,0.5 -1.5,0.5 z M 10.5,9.5 h 1 q 0.5,0 1,-0.5 0.5,-0.5 0.5,-1 0,-0.5 -0.5,-1 -0.5,-0.5 -1,-0.5 h -1 z m 1,7.5 q 1,0 1.5,-0.5 0.5,-0.5 0.5,-1 0,-0.5 -0.5,-1 -0.5,-0.5 -1.5,-0.5 h -1 v 2.5 z"
  ],
  Italic: [
    "M 19.5,2 19,5 H 16 L 12.5,19 h 3 L 15,22 H 4.5 L 5,19 H 8 L 11.5,5 H 8 L 8.5,2 Z"
  ],
  Underline: [
    "m 13.5,2 v 8.5 c 0,1 -0.5,2 -1.5,2 -1.5,0 -1.5,-1 -1.5,-2 V 2 H 4.5 v 9.5 c 0,4.5 3,6.5 7.5,6.5 4.5,0 7.5,-2 7.5,-6.5 V 2 Z",
    "m 2 20 h 20 v 2 H 2 Z"
  ],
  Strike: [
    "m 12.125,22.000007 q -2.3888907,0 -4.2222255,-0.944445 Q 6.0972176,20.111117 4.791661,18.222226 l 2.0555571,-2.361113 q 1.3611122,1.944446 2.6111132,2.694447 1.2500007,0.75 2.9722247,0.75 1.055556,0 1.916668,-0.333333 0.861112,-0.333334 1.361112,-0.916668 0.500001,-0.583333 0.500001,-1.333334 0,-0.5 -0.166667,-0.944445 -0.166667,-0.444445 -0.527778,-0.805556 -0.333334,-0.361112 -0.88889,-0.666667 -0.527778,-0.305556 -1.250001,-0.527779 -0.722223,-0.25 -1.666668,-0.416667 -1.500001,-0.305555 -2.6111131,-0.805556 -1.111112,-0.5 -1.8611126,-1.250001 -0.7500005,-0.75 -1.1111119,-1.6944456 Q 5.763884,8.6388854 5.763884,7.44444 q 0,-1.5833346 0.8888896,-2.8055578 0.8888895,-1.2222231 2.3888907,-1.9166681 1.5277787,-0.7222228 3.4166697,-0.7222228 2.250001,0 3.916669,0.8888896 1.694446,0.8611118 2.666669,2.5277797 l -2.111113,2.083335 Q 16.097225,6.1388834 14.930558,5.4166606 13.791668,4.6944378 12.375,4.6944378 q -1.083334,0 -1.88889,0.3333336 -0.8055563,0.3333336 -1.2777789,0.9444452 -0.4444448,0.5833338 -0.4444448,1.38889 0,0.5833338 0.2222224,1.0833342 0.2222224,0.4722226 0.6666672,0.8611118 0.4722231,0.3611114 1.2500011,0.6666672 0.777778,0.2777782 1.861112,0.5000002 1.527779,0.333334 2.722225,0.861112 1.194445,0.5 2.027779,1.194445 0.833334,0.694445 1.250001,1.555557 0.444445,0.861112 0.444445,1.861113 0,1.861112 -0.861112,3.222224 -0.861112,1.361113 -2.444446,2.111113 -1.583335,0.722223 -3.777781,0.722223 z",
    "m 2 11 h 20 v 2 H 2 Z"
  ],
  UList: [
    "M 6,12 A 2,2 0 0 1 4,14 2,2 0 0 1 2,12 2,2 0 0 1 4,10 2,2 0 0 1 6,12 Z",
    "M 6,20 A 2,2 0 0 1 4,22 2,2 0 0 1 2,20 2,2 0 0 1 4,18 2,2 0 0 1 6,20 Z",
    "M 6,4 A 2,2 0 0 1 4,6 2,2 0 0 1 2,4 2,2 0 0 1 4,2 2,2 0 0 1 6,4 Z",
    "m 9,3 h 12 c 0.554,0 1,0.446 1,1 0,0.554 -0.446,1 -1,1 H 9 C 8.446,5 8,4.554 8,4 8,3.446 8.446,3 9,3 Z",
    "m 9,11 h 12 c 0.554,0 1,0.446 1,1 0,0.554 -0.446,1 -1,1 H 9 C 8.446,13 8,12.554 8,12 8,11.446 8.446,11 9,11 Z",
    "m 9,19 h 12 c 0.554,0 1,0.446 1,1 0,0.554 -0.446,1 -1,1 H 9 C 8.446,21 8,20.554 8,20 8,19.446 8.446,19 9,19 Z"
  ],
  NList: [
    "M 5.5142864,1.9999989 V 8 H 3.2857146 V 4.0571421 L 2,4.4857136 V 2.599999 L 3.4571432,1.9999989 Z",
    "M 8.1714278,6.285714 V 8 H 6.3714275 V 6.285714 Z",
    "m 12.74126,10.888112 q 0,0.268532 -0.07553,0.511888 -0.07552,0.234965 -0.201398,0.444756 -0.125874,0.20979 -0.285315,0.394405 -0.159441,0.176224 -0.318881,0.318881 -0.394406,0.335665 -0.881119,0.595805 h 1.678322 v 1.846154 H 8.1258743 v -1.678322 q 0.6545456,-0.402797 1.1748254,-0.805595 0.2181819,-0.167832 0.4279721,-0.352447 0.2181819,-0.184616 0.3776222,-0.36084 0.167832,-0.184615 0.268532,-0.352447 0.100699,-0.167832 0.100699,-0.31049 0,-0.193007 -0.125874,-0.302098 -0.117483,-0.117482 -0.335664,-0.117482 -0.268532,0 -0.4867138,0.07552 -0.2181819,0.06713 -0.3860141,0.159441 -0.193007,0.100699 -0.344056,0.226573 L 8.0000001,9.9230768 Q 8.2433568,9.6713285 8.5790212,9.4615383 8.8727276,9.2937061 9.3090913,9.1510487 9.745455,8.9999997 10.349651,8.9999997 q 0.553846,0 0.99021,0.1594406 0.444755,0.1594406 0.755245,0.4279721 0.310489,0.2601399 0.478322,0.6041956 0.167832,0.335665 0.167832,0.696504 z",
    "m 2.517489,2.433567 v 1.678322 h -1.762238 v -1.678322 z",
    "m 18.314686,18.517482 q 0.394406,0.09231 0.713287,0.302098 0.134266,0.09231 0.26014,0.218182 0.125874,0.117483 0.226573,0.285315 0.1007,0.159441 0.159441,0.369231 0.06713,0.201398 0.06713,0.461538 0,0.344056 -0.167832,0.679721 -0.167832,0.327273 -0.478322,0.587412 -0.31049,0.26014 -0.755245,0.419581 -0.436364,0.159441 -0.99021,0.159441 -0.604196,0 -1.04056,-0.142658 -0.436363,-0.142657 -0.73007,-0.318881 Q 15.243357,21.337063 15,21.076923 l 0.797203,-1.258741 q 0.151049,0.134266 0.344056,0.234965 0.167832,0.09231 0.386014,0.159441 0.218182,0.06713 0.486714,0.06713 0.218182,0 0.335664,-0.109091 0.125874,-0.109091 0.125874,-0.268532 0,-0.159441 -0.125874,-0.268531 -0.117482,-0.109091 -0.335664,-0.109091 H 16.3007 v -1.09091 l 1.006993,-0.671329 h -1.93007 v -1.762238 h 4.111889 v 1.762238 z",
    "m 3.860143,1.678322 v 1.678322 h -1.762238 v -1.678322 z"
  ],
  Mic: [
    "m 12,2 c 2.216,0 4,1.784 4,4 v 5 c 0,2.216 -1.784,4 -4,4 C 9.784,15 8,13.216 8,11 V 6 C 8,3.784 9.784,2 12,2 Z",
    "m 9,20 h 6 c 0.554,0 1,0.446 1,1 0,0.554 -0.446,1 -1,1 H 9 C 8.446,22 8,21.554 8,21 8,20.446 8.446,20 9,20 Z",
    "m 5.0898437,10 a 1.051545,1.051545 0 0 0 -1.0878906,1.015625 c 0,0 -0.084818,1.953484 0.8828125,3.943359 C 5.8523961,16.948859 8.0702599,19 12,19 c 3.92974,0 6.147603,-2.051141 7.115234,-4.041016 0.967631,-1.989875 0.882813,-3.943359 0.882813,-3.943359 A 1.051545,1.051545 0 0 0 18.910156,10 1.051545,1.051545 0 0 0 17.896484,11.087891 c 0,0 0.03544,1.49455 -0.673828,2.953125 C 16.513385,15.49959 15.256982,16.896484 12,16.896484 8.7430185,16.896484 7.486615,15.49959 6.7773437,14.041016 6.0680725,12.582441 6.1035156,11.087891 6.1035156,11.087891 A 1.051545,1.051545 0 0 0 5.0898437,10 Z"
  ],
  EditText: [
    "M 9.6276895,19.843369 8.969346,16.211129 H 5.8592406 l -0.6129405,3.63224 H 1.9999856 L 5.0873896,4.1112291 H 9.832003 L 12.874004,19.843369 Z M 6.3359721,13.328038 H 8.469913 L 7.3802411,7.2440361 Z m 10.4426969,2.633374 v 0.635642 q 0,0.771851 0.794553,0.771851 0.681045,0 1.135075,-0.249716 v -2.746882 l -1.044269,0.272418 q -0.567538,0.158911 -0.726448,0.408627 -0.158911,0.249717 -0.158911,0.90806 z M 14.122594,6.7673046 q 1.248582,-0.4313285 3.564135,-0.4313285 2.315553,0 3.314419,1.0215675 0.998866,0.998866 0.998866,3.0420014 v 9.443824 h -3.200911 v -0.976165 q -0.658344,1.021568 -2.292852,1.021568 -1.634508,0 -2.360956,-0.771851 -0.726448,-0.794553 -0.726448,-2.519867 v -0.771851 q 0,-1.521 0.658344,-2.338254 0.681045,-0.817254 2.179344,-1.225881 l 2.474463,-0.635642 v -1.248583 q -0.0227,-0.5902389 -0.340522,-0.8172539 -0.317821,-0.2497165 -1.157777,-0.2497165 -1.884224,0 -3.110105,0.4767315 z"
  ],
  Clip: [
    "M 12.873047,2.0078125 C 11.51558,2.0810486 10.036979,2.7338757 9.1796875,4.21875 l -4.4726563,7.746094 a 0.965855,0.965855 0 0 0 0.3535157,1.320312 0.965855,0.965855 0 0 0 1.3183593,-0.353515 L 10.851563,5.1855469 c 0.524085,-0.9077438 1.240145,-1.2003085 2.125,-1.2480469 0.884854,-0.047738 1.896389,0.2588461 2.513671,0.6152344 0.666326,0.3847029 1.397271,1.0158011 1.753907,1.7128906 0.356635,0.6970895 0.458364,1.4147774 -0.173829,2.5097656 L 11.322266,18.734375 C 10.682853,19.84187 9.9287003,20.066796 9.0625,20.068359 8.1962997,20.069923 7.2500654,19.696187 6.8730469,19.478516 6.6471406,19.348088 6.7258374,19.375937 6.7304687,19.251953 c 0.0046,-0.123052 0.053944,-0.244244 0.054687,-0.246094 5.7e-6,-1.4e-5 0,-0.002 0,-0.002 L 13.095703,8.0742188 c 0.212914,-0.2820534 0.409927,-0.2407716 0.478516,-0.2011719 -0.06678,-0.038558 0.04473,0.053634 0.08398,0.2050781 0.03925,0.1514445 -0.01894,0.3042442 0.0293,0.2207031 L 9.8535156,14.9375 a 0.965855,0.965855 0 0 0 0.3535154,1.320312 0.965855,0.965855 0 0 0 1.320313,-0.353515 L 15.361328,9.2636719 C 15.69457,8.6864781 15.66278,8.1163163 15.527344,7.59375 15.391908,7.0711837 15.127483,6.5389438 14.539063,6.1992187 13.56519,5.6369529 12.258527,5.9457054 11.533203,6.9316406 l -0.03125,0.042969 -6.4296874,11.1347656 -0.013672,0.02539 c 0,0 -0.2374221,0.446772 -0.2597656,1.044921 -0.022343,0.59815 0.2900535,1.498795 1.1074219,1.970704 C 6.5725057,21.535052 7.7085589,22.002447 9.0644531,22 10.420347,21.997553 12.02936,21.372221 12.994141,19.701172 l 5.75,-9.9589845 C 19.652249,8.1693001 19.569399,6.5683996 18.964844,5.3867187 18.360288,4.2050379 17.353664,3.3977052 16.455078,2.8789063 15.50745,2.331792 14.230514,1.9345764 12.873047,2.0078125 Z"
  ],
  Poll: [
    "m 10.2,2 h 3.6 c 0.4986,0 0.9,0.4014 0.9,0.9 v 18.2 c 0,0.4986 -0.4014,0.9 -0.9,0.9 H 10.2 C 9.7014002,22 9.3000002,21.5986 9.3000002,21.1 V 2.9 C 9.3000002,2.4014 9.7014002,2 10.2,2 Z",
    "m 2.9,6 h 3.6000001 c 0.4986,0 0.9,0.4014 0.9,0.9 v 14.2 c 0,0.4986 -0.4014,0.9 -0.9,0.9 H 2.9 C 2.4014,22 2,21.5986 2,21.1 V 6.9 C 2,6.4014 2.4014,6 2.9,6 Z",
    "m 17.9,11.947126 h 3.6 c 0.4986,0 0.9,0.4014 0.9,0.9 v 8.2 c 0,0.4986 -0.4014,0.9 -0.9,0.9 h -3.6 c -0.4986,0 -0.9,-0.4014 -0.9,-0.9 v -8.2 c 0,-0.4986 0.4014,-0.9 0.9,-0.9 z"
  ]
};